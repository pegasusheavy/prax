#!/bin/sh
#
# Pre-push hook: Full test suite
# Runs before pushing to ensure all tests pass
#

set -e

echo "üöÄ Running pre-push checks..."

# Check if cargo is available
if ! command -v cargo &> /dev/null; then
    echo "‚ùå cargo not found. Please install Rust."
    exit 1
fi

# Build check
echo "üî® Building project..."
if ! cargo build --all-features; then
    echo ""
    echo "‚ùå Build failed!"
    exit 1
fi
echo "‚úÖ Build OK"

# Run tests
echo "üß™ Running tests..."
if ! cargo test --all-features; then
    echo ""
    echo "‚ùå Tests failed!"
    exit 1
fi
echo "‚úÖ Tests OK"

# Run doc tests
echo "üìö Running doc tests..."
if ! cargo test --doc --all-features; then
    echo ""
    echo "‚ùå Doc tests failed!"
    exit 1
fi
echo "‚úÖ Doc tests OK"

# Check documentation builds
echo "üìñ Checking documentation..."
if ! cargo doc --no-deps --all-features 2>/dev/null; then
    echo ""
    echo "‚ö†Ô∏è  Warning: Documentation has issues."
fi
echo "‚úÖ Documentation OK"

echo ""
echo "‚úÖ All pre-push checks passed! Safe to push."

